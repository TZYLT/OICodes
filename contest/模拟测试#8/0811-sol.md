### T1

首先特判 $L=R$ 的情况，如果 $L=R=1$ 则输出 $(1,1)$，否则无解。

如果区间长度是偶数，那么因为相邻整数一定是互质的，因此可以 $(L,L+1),(L+1,L),(L+2,L+3),(L+3,L+2),\cdots$ 这样构造，一定有解。

如果区间长度是奇数，并且 $L$ 是偶数，那么偶数个数严格超过区间长度的一半，因此不管怎么排列，一定有一对 $x,y$ 全是偶数，必然不合法，否则，因为 $\gcd(L,L+2)=1$，因此可以对于前三个数可以 $(L,L+1),(L+1,L+2),(L+2,L)$ 这样构造，剩余部分用区间长度是偶数的方法即可。

### T2

方便起见添加 $0$ 号点，指向所有入度为 $0$ 的点，以及 $n+1$ 号点，所有出度为 $0$ 的点都向 $n+1$ 连边，这样原图中的一条链相当于新图中一条 $0$ 到 $n+1$ 的链。

预处理出 $dp_{i,j}$ 表示图中 $i$ 到 $j$ 的路径有多少条，回答询问的时候容斥，钦定一个集合 $S=\{y_1,y_2,\cdots,y_k\}(y_1<y_2<\cdots<y_k)$ 中的点必须被这条链经过，那么方案数为 $dp_{0,y_1}·dp_{y_1,y_2}·dp_{y_2,y_3}·\cdots·dp_{y_{k-1},y_k}·dp_{y_k,n+1}$，乘以容斥系数 $(-1)^k$ 求和就是答案。

直接暴力枚举是 $2^k$ 的，但是注意到如果我们按照下标顺序考虑每个 $x_i$ 的话，那么这个式子只与目前最后一个属于 $S$ 的 $x_i$ 有关，因此考虑设 $f_i$ 表示 $y_k=x_i$ 的所有 $S$ 的容斥系数乘以方案数之和，转移 $-f_i·dp_{x_i,x_j}\to f_j$。

时间复杂度 $O(nm+k\sum k)$。

### T3

考虑枚举这 $t$ 个数在十进制下的最长公共前缀，设它的长度为 $i$，那么必然存在一个数等于 $xxx...x122222...2$，其中前面这串 $xxxx..xx$ 的长度为 $i$，后面的部分是一个 $1$ 后面跟一串 $2$。我们枚举这个数是这 $t$ 个数中的第几个，设为 $k$，设前面这串 $xx...x$ 组成的数为 $X$，那么实际上这 $k$ 个数在 $X,k,i$ 确定的时候已经定下来了，具体来说存在数组 $V_1,V_2,\cdots,V_t$ 使得第 $i$ 个数刚好是 $X·10^{n-i}+V_i$，这样它们的乘积也可以表示为与 $X$ 有关的 $t$ 次多项式，预处理出这个系数以后我们的任务就变为，对所有 $0\le i\le t$，求出所有可能的 $X^i$ 之和。这个可以数位 DP，设 $dp_{i,0/1,k}$ 表示考虑了最高的 $i$ 位，目前有 / 没有达到上界的所有 $X^k$ 之和，转移相当于在一串 $x_1,x_2,\cdots,x_p$ 后面添上 $1/2$，求新的 $\sum x_i^k$ 之和。因为在一个数后面添 $1$ 相当于将这个数乘以 $10$ 再加 $1$，所以这个相当于求 $\sum (10x_i+1)^k$，使用二项式定理展开以后可以 $O(t^2)$ 地进行转移。

### T4

首先注意到本质不同的值只有 $O(\sqrt{X})$ 种，因为对于两个数 $x,y$，如果 $\lfloor\dfrac{X}{x}\rfloor=\lfloor\dfrac{X}{y}\rfloor$，那么对于一个目前乘积为 $x$ 的连通块和一个目前乘积为 $y$ 的连通块而言，不论再往里面添 $a$ 为多少的元素，乘积是否超过 $X$ 的情况都是相同的。

考虑点分治，每次统计经过根节点的连通块个数。对于连通块计数这类问题有这样一种 DP 方式：DFS，实时维护 $dp_{x,i}$ 表示有多少个连通块包含根节点和 $x$，且乘积为 $i$，转移就依次枚举 $x$ 的每个儿子 $y$，将 $dp_{x,i}\to dp_{y,ia_y}$，继续 DFS $y$ 这个子树，回溯的时候再反过来用 $dp_{y,i}$ 更新 $dp_{x,i}$ 即可。

时间复杂度 $O(n\sqrt{X}\log n)$。